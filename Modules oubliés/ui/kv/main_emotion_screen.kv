#:kivy 2.0.0
#: import hex kivy.utils.get_color_from_hex

<EmotionalCore>:
    # Configuration de l'effet de flou pour le cœur émotionnel
    canvas:
        # Couche de base - l'orbe centrale
        PushMatrix
        Scale:
            origin: self.center
            x: self.pulse_scale
            y: self.pulse_scale
        Color:
            rgba: self.base_color
        Ellipse:
            pos: self.center_x - min(self.width, self.height) * 0.2, self.center_y - min(self.width, self.height) * 0.2
            size: min(self.width, self.height) * 0.4, min(self.width, self.height) * 0.4

        # Ajouter un halo interne légèrement plus lumineux
        Color:
            rgba: [min(1, self.base_color[0] * 1.3), min(1, self.base_color[1] * 1.3), min(1, self.base_color[2] * 1.3), self.base_color[3] * 0.7]
        Ellipse:
            pos: self.center_x - min(self.width, self.height) * 0.13, self.center_y - min(self.width, self.height) * 0.13
            size: min(self.width, self.height) * 0.26, min(self.width, self.height) * 0.26

        # Ajouter un éclat subtil au centre
        Color:
            rgba: [min(1, self.base_color[0] * 1.7), min(1, self.base_color[1] * 1.7), min(1, self.base_color[2] * 1.7), self.base_color[3] * 0.9]
        Ellipse:
            pos: self.center_x - min(self.width, self.height) * 0.05, self.center_y - min(self.width, self.height) * 0.05
            size: min(self.width, self.height) * 0.1, min(self.width, self.height) * 0.1

        # Halo externe doux (qui change avec l'émotion)
        Color:
            rgba: self.halo_color
        Ellipse:
            pos: self.center_x - min(self.width, self.height) * 0.3, self.center_y - min(self.width, self.height) * 0.3
            size: min(self.width, self.height) * 0.6, min(self.width, self.height) * 0.6

        # Patterns internes complexes et flous (pour donner une sensation de profondeur et de mouvement)
        Color:
            rgba: [self.base_color[0] * 0.7, self.base_color[1] * 0.7, self.base_color[2] * 0.7, self.base_color[3] * 0.5]
        Ellipse:
            pos: self.center_x - min(self.width, self.height) * 0.15, self.center_y - min(self.width, self.height) * 0.15
            size: min(self.width, self.height) * 0.3, min(self.width, self.height) * 0.3
            angle_start: 0
            angle_end: 270
        PopMatrix

<ParticleSystem>:
    # Ce widget sera rempli dynamiquement par le code Python

<DreamBackground>:
    # Ce widget sera rempli dynamiquement par le code Python

<MainEmotionScreen>:
    name: 'main_emotion'
    # La structure est entièrement contrôlée par le code Python pour une meilleure flexibilité
